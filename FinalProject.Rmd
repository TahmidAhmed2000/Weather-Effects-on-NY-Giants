---
title: "FinalProject"
author: "Tahmid Ahmed"
date: "4/26/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(readr)
library(tidyverse)
library(janitor)
library(reprex)
library(gt)
library(xml2)
library(ggthemes)
```

```{r kicker, echo=FALSE, include=FALSE}
# Downloading Kicker Data
url_kickers = "https://raw.githubusercontent.com/Nolanole/NFL-Weather-Project/master/Game_Logs_Kickers.csv"
url_kickers <- read_csv(url(url_kickers)) 
url_kickers
```

```{r qbweather, include = FALSE, echo = FALSE}
# Qb and weather data merged
url_qbweather = "https://raw.githubusercontent.com/Nolanole/NFL-Weather-Project/master/QB_weather_cleaned.csv"
url_qbweather<- read_csv(url(url_qbweather))
url_qbweather
```

```{r rb, include = FALSE, echo = FALSE}
# Downloading rb data
url_rb = "https://raw.githubusercontent.com/Nolanole/NFL-Weather-Project/master/Game_Logs_Runningback.csv"
url_rb <- read_csv(url(url_rb))
```

```{r weat, include = FALSE, echo = FALSE}
# weather in all games 
url_weathergit = "https://raw.githubusercontent.com/Nolanole/NFL-Weather-Project/master/all_games_weather.csv"
url_weathergit <- read_csv(url(url_weathergit))
```

```{r stadium, include = FALSE, echo = FALSE}
url_stadium = "https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-02-04/attendance.csv"
url_stadium <- read_csv(url(url_stadium))
```

```{r giants, echo=FALSE}
giantsweather <- url_weathergit %>%
  filter(away == "New York Giants" | home == "New York Giants") %>%
  slice(495:627) %>%
  slice(-c(33:36, 117)) %>%
  mutate(id = 1:n()) %>%
  mutate(giants_points = ifelse(home == "New York Giants", score_home, score_away))

saveRDS(giantsweather, file = "final_project_shiny/giants_weather.rds")


giants_stadium <- url_stadium %>%
  filter(team_name == "Giants" & (year == 2010 | year == 2011 | year == 2012 | year == 2013 | year == 2014 | year == 2015 | year == 2016 | year == 2017) & weekly_attendance != "NA") %>%
  mutate(id = 1:n())
```

```{r joineddata, echo=FALSE}

joineddata <- left_join(giantsweather, giants_stadium, by = "id")

saveRDS(joineddata, file = "final_project_shiny/joined.rds")

```

```{r attendance, echo=FALSE}

# Attendance plot
ggplot(joineddata, aes(avg_temp, weekly_attendance)) +
  geom_point() + geom_smooth(method = "lm") +
  theme_classic() +
  labs(title = "Weather's Impact on Attendance of Giants Games",
       subtitle = "Appears to be no correlation") +
  ylab("Attendance") +
  xlab("Temperature")

```

```{r eli, echo=FALSE}

EM_regular <- url_qbweather %>%
filter(name == "Manning, Eli", season == "Regular Season")

```

```{r echo=FALSE}

url_qbweather %>%
filter(name == "Manning, Eli", season == "Regular Season") %>%
  ggplot(aes(avg_wind, yards)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  theme_classic() +
  labs(title = "Weather Impact on Eli Manning's Yardage During the Regular Season") +
  labs(subtitle = "At start of career to 2017") +
  ylab("Yards") +
  xlab("Temperature")
```

```{r}


view( url_rb %>%
  filter(Name == "Barber, Tiki" | Name == "Jacobs, Brandon", 
         ((Year == 2000 | Year == 2001 | Year == 2002 | Year == 2003 | Year == 2004 | Year == 2005 | Year == 2006 | Year == 2007 | Year == 2008 | Year == 2009 | Year == 2010 | Year == 2011 | Year == 2012 | Year == 2013 | Year == 2014 | Year == 2015 | Year == 2016 | Year == 2017)),
         Season == "Regular Season"
         ))



```

```{r}
giantsrb <- url_rb %>% filter(grepl(c("2010|2011|2012|2013|2014|2015|2016|2017"), Year)) %>%
  filter(Season == "Regular Season", Name == "Jacobs, Brandon" | Name == "Jennings, Rashad") %>%
    slice(-c(108:120)) %>%
    slice(-c(49:95))

```




